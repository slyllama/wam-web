<script type="text/javascript">
	function submitCartEmail() {
		var emailText = "";
		emailText += "Enquiry Cart For Processing and Payment - Pipeline Industries\n";
		emailText += "\n";
		
		emailText += "Products:\n";
		for (const item in cart) {
			emailText += " - " + cart[item].qty + " x " + cart[item].name + ": " + item + "\n";
		}
		emailText += "\n";
		
		emailText += "Customer details:\n";
		emailText += " - Name: " + document.getElementById("cart--name").value + "\n";
		window.location.href = "mailto:alex.laing@me.com?body=" + encodeURIComponent(emailText);
	}

	function modifyItem(code, id, title, qty) {
		addToCart(code, id, title, qty);
		refreshCartTable();
	}

	function refreshCartTable() {
		var tableStart = ("<tbody id='product-table'><tr id='row--Code'>"
			+ "<td>Code</td><td>Quantity</td></tr>");
		var tableEnd = "</tbody>";
		
		var table = tableStart;
		for (const item in cart) {
			table += "<tr>";

			// Add the product and SKU associated with this cart entry
			table += "<td><b><a style='text-decoration: none;'";
			table += "href='../../product/" + cart[item].id + "'>";
			table += cart[item].name + "</a></b>: <code style='font-size: 10pt;'>" + item + "</code></td>";

			var qtyNumberId = "product-qty--" + item;
			table += "<td id='row--" + item + "'>";
			table += "<input type='number' style='width: 40px;' value=";
			table += cart[item].qty;
			table += " min=0 id='";
			table += qtyNumberId + "'";
			table += "onchange=\"";
			table += ("modifyItem('" + item + "', '"
				+ cart[item].id + "', '" + cart[item].name
				+ "', document.getElementById('"
				+ qtyNumberId + "').value);\"");
			table += "id='" + qtyNumberId + "'/>";
			table += "</td>";
			table += "</tr>";
		}
		table += tableEnd;
		document.getElementById("product-table").innerHTML = table;
	}
</script>

<h1>Enquiry Cart</h1>

<div class="info">
	<p>You can email product enquiry to your local branch for processing and payment.</p>
</div>

<div class="table-wrapper">
	<table>
		<tbody id="product-table">
		<tr id="row--Code">
			<td>Code</td>
		</tr>
		</tbody>
	</table>
</div>

<script>refreshCartTable();</script>

<h2>Send Enquiry Cart</h2>

<div id="enquiry-container">
	<div>
		<p>Name/company<span style="color: red;">*</span>:
		</p><input id="cart--name" class="enquiry-field" />
	</div>
	<div>
		<p>Email address<span style="color: red;">*</span>:</p>
		<input id="cart--email" class="enquiry-field" />
	</div>
	<div>
		<p>Phone number (optional):</p>
		<input id="cart--phone" class="enquiry-field" />
	</div>
</div>

<p>Notes: <textarea id="cart--notes" class="enquiry-field" rows=5></textarea></p>

<button class="enquiry-submit" onclick="submitCartEmail();">Send Enquiry Cart For Processing and Payment</button>

